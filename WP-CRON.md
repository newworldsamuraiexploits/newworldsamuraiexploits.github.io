# WordPress WP-Cron Leads to Access of Hosting Server.

The WPScan tool is a free, for non-commercial use, black box WordPress security scanner written for security professionals and blog maintainers to test the security of their sites.  There are over 37,000 WordPress vulnerabilities.
Here we will be exploiting WP-Cron. 

# PoC Video
<iframe width="560" height="315" src="https://www.youtube.com/embed/UB4Gygxc4zw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

# Lab Setup
This lab is not my creation so no build scripts will be provided.  However there is a plethora of WordPress machiness avaliable on Proving Grounds Play. 

[Proving Grounds Play](https://portal.offensive-security.com/labs/play)

# Walkthrough

Determine if the WordPress admin portal is open. Typically site/wp-admin
Use the wpscan flag -e u to enumerate usernames. 

<img src="./wpcron1.PNG">


<img src="./wpcron2.PNG">


Use the found users with a wordlist to bruteforce the password

<img src="./wpcron3.PNG">


Access the admin dashboard's Theme Editor from the Apperance menu.

<img src="./wpcron5.PNG">


A tried and true method to gain a foothold to the hosting server is over writting a Theme File with a reverse PHP shell.  Here we updates 404.php with php code [pentestmonkey's php-reverse-shell](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php)

Thank you pentestmonkey!

<img src="./wpcron6.PNG">


Start a netcat listener and the browse to https://thesite.com/wp-content/themes/themeversion/modifiedthemefile.php to get a foothold on the hosting server. 

<img src="./wpcron7.PNG">


YES its that easy!

<img src="./wpcron8.PNG">



# Remediation
Disable WP-CRON, disallow admin portal access from untrusted zones, and use two factor authentication.




